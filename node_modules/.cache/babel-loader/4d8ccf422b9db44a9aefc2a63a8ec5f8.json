{"ast":null,"code":"import { FAIL, GET_CURRENT, LOGIN, REGISTER, LOGOUT } from \"../types/authTypes\";\nimport axios from \"axios\";\nexport const register = (newuser, Navigate) => async dispatch => {\n  try {\n    //register wala login method post \n    //..nahkyy  maa lback \n    const res = await axios.post('/auth/signup', newuser);\n    dispatch({\n      type: REGISTER,\n      payload: res.data\n    }); //  nrajaa3 f user msg o tokeen\n\n    console.log(res.data);\n    Navigate('/Profile');\n  } catch (error) {\n    dispatch({\n      type: FAIL,\n      payload: error.response.data\n    });\n  }\n};\nexport const login = (user, Navigate) => async dispatch => {\n  try {\n    const res = await axios.post('/auth/signIn', user);\n    dispatch({\n      type: LOGIN,\n      payload: res.data\n    });\n    console.log(res.data);\n\n    if (res.data.user.role === \"user\") {\n      Navigate('/Profile');\n    }\n\n    if (res.data.user.role === \"admin\") {\n      Navigate('/Admin');\n    }\n  } catch (error) {\n    dispatch({\n      type: FAIL,\n      payload: error.response.data\n    });\n  }\n};\nexport const getcurrent = () => async dispatch => {\n  const token = localStorage.getItem('token');\n  const config = {\n    headers: {\n      authorization: token\n    }\n  };\n\n  try {\n    const res = await axios.get('/auth/current', config);\n    dispatch({\n      type: GET_CURRENT,\n      paylod: res.data\n    });\n  } catch (error) {\n    console.log(error);\n  }\n};\nexport const logout = Navigate => {\n  Navigate(\"/\");\n  return {\n    type: LOGOUT\n  };\n}; //get user\n\nexports.Getuser = async (req, res) => {\n  try {\n    const listOfUsers = await UserSchema.find({\n      role: \"user\"\n    });\n    res.status(200).send({\n      msg: \"list of users\",\n      listOfUsers\n    });\n  } catch (error) {\n    res.status(500).send({\n      msg: \"could not get users\",\n      error\n    });\n  }\n};","map":{"version":3,"sources":["/home/salma/Bureau/animalerie ðŸˆ/authentification/authfront/src/redux/actions/authAction.js"],"names":["FAIL","GET_CURRENT","LOGIN","REGISTER","LOGOUT","axios","register","newuser","Navigate","dispatch","res","post","type","payload","data","console","log","error","response","login","user","role","getcurrent","token","localStorage","getItem","config","headers","authorization","get","paylod","logout","exports","Getuser","req","listOfUsers","UserSchema","find","status","send","msg"],"mappings":"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","sourcesContent":["import {FAIL, GET_CURRENT , LOGIN, REGISTER,LOGOUT} from \"../types/authTypes\"\nimport axios from \"axios\"\n\nexport const register =(newuser, Navigate )=>async (dispatch)=>{\n\ntry {\n    //register wala login method post \n\n    //..nahkyy  maa lback \n    const res= await  axios.post ('/auth/signup', newuser)\n    dispatch ({\n        type : REGISTER, \n        payload:res.data\n    }) ; //  nrajaa3 f user msg o tokeen\n    console.log(res.data);\nNavigate('/Profile')\n    \n} catch (error) {\n    dispatch({type : FAIL , payload : error.response.data }) ; \n}\n\n}; \n\nexport const login = (user, Navigate)=> async (dispatch)=> {\n    try {\n        const res = await axios.post('/auth/signIn', user ) ;\n\n        dispatch ({type: LOGIN , payload : res.data }) ; \n        console.log(res.data);\nif(res.data.user.role===\"user\")\n     { Navigate('/Profile')}\n     if(res.data.user.role===\"admin\")\n     { Navigate('/Admin')}\n    } catch (error) {\n        dispatch ({type : FAIL , payload : error.response.data})  \n    }\n}\n\n\nexport const getcurrent=()=> async(dispatch)=>{\n\nconst token =localStorage.getItem('token')\nconst config = {\n    headers : {\n        authorization : token ,\n    },\n}\n\n    try {\n        \n        const res = await axios.get('/auth/current',config);\n        \n        dispatch({type:GET_CURRENT ,paylod:res.data})\n        \n    } catch (error) {\n        console.log(error)\n        \n    }\n}\nexport const logout = (Navigate)=>{\n    Navigate(\"/\")    \n    return{\n    type:LOGOUT,\n    }\n}\n\n\n//get user\n\nexports.Getuser = async(req,res)=>{\n    try {\n        const listOfUsers = await UserSchema.find({role:\"user\"});\n        res.status(200).send({msg:\"list of users\",listOfUsers});\n\n    } catch (error) {\n        res.status(500).send({msg:\"could not get users\",error});\n    }\n}"]},"metadata":{},"sourceType":"module"}